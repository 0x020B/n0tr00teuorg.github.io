{"version":3,"file":"bs-car-reader.cjs","sources":["../../src/bs-car-reader.js"],"sourcesContent":["/**\r\n * An implementation of the CAR reader interface that is backed by a blockstore.\r\n *\r\n * @typedef {import('multiformats').CID} CID\r\n * @typedef {import('@ipld/car/api').CarReader} CarReader\r\n * @implements {CarReader}\r\n */\r\nexport class BlockstoreCarReader {\r\n  /**\r\n   * @param {number} version\r\n   * @param {CID[]} roots\r\n   * @param {import('ipfs-car/blockstore').Blockstore} blockstore\r\n   */\r\n  constructor(version, roots, blockstore) {\r\n    /**\r\n     * @private\r\n     */\r\n    this._version = version\r\n    /**\r\n     * @private\r\n     */\r\n    this._roots = roots\r\n    /**\r\n     * @private\r\n     */\r\n    this._blockstore = blockstore\r\n  }\r\n\r\n  get version() {\r\n    return this._version\r\n  }\r\n\r\n  get blockstore() {\r\n    return this._blockstore\r\n  }\r\n\r\n  async getRoots() {\r\n    return this._roots\r\n  }\r\n\r\n  /**\r\n   * @param {CID} cid\r\n   */\r\n  has(cid) {\r\n    return this._blockstore.has(cid)\r\n  }\r\n\r\n  /**\r\n   * @param {CID} cid\r\n   */\r\n  async get(cid) {\r\n    const bytes = await this._blockstore.get(cid)\r\n    return { cid, bytes }\r\n  }\r\n\r\n  blocks() {\r\n    return this._blockstore.blocks()\r\n  }\r\n\r\n  async *cids() {\r\n    for await (const b of this.blocks()) {\r\n      yield b.cid\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAM,mBAAmB,CAAC;AACjC;AACA;AACA;AACA;AACA;AACA,EAAE,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE;AAC1C;AACA;AACA;AACA,IAAI,IAAI,CAAC,QAAQ,GAAG,QAAO;AAC3B;AACA;AACA;AACA,IAAI,IAAI,CAAC,MAAM,GAAG,MAAK;AACvB;AACA;AACA;AACA,IAAI,IAAI,CAAC,WAAW,GAAG,WAAU;AACjC,GAAG;AACH;AACA,EAAE,IAAI,OAAO,GAAG;AAChB,IAAI,OAAO,IAAI,CAAC,QAAQ;AACxB,GAAG;AACH;AACA,EAAE,IAAI,UAAU,GAAG;AACnB,IAAI,OAAO,IAAI,CAAC,WAAW;AAC3B,GAAG;AACH;AACA,EAAE,MAAM,QAAQ,GAAG;AACnB,IAAI,OAAO,IAAI,CAAC,MAAM;AACtB,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,GAAG,CAAC,GAAG,EAAE;AACX,IAAI,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC;AACpC,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,MAAM,GAAG,CAAC,GAAG,EAAE;AACjB,IAAI,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,EAAC;AACjD,IAAI,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE;AACzB,GAAG;AACH;AACA,EAAE,MAAM,GAAG;AACX,IAAI,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;AACpC,GAAG;AACH;AACA,EAAE,OAAO,IAAI,GAAG;AAChB,IAAI,WAAW,MAAM,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE;AACzC,MAAM,MAAM,CAAC,CAAC,IAAG;AACjB,KAAK;AACL,GAAG;AACH;;;;"}